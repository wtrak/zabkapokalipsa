// Full code remains the same up until the submit event listener

    document.getElementById('gameForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const selected = Array.from(document.querySelectorAll("input[name='item']:checked"));
      if (selected.length !== 10) {
        alert(currentLang === 'pl' ? 'Musisz wybraƒá dok≈Çadnie 10 przedmiot√≥w!' : 'You must choose exactly 10 items!');
        return;
      }

      const total = selected.reduce((sum, el) => sum + parseInt(el.value), 0);
      const tagCounts = {};
      const selectedTags = [];

      selected.forEach(el => {
        const tag = el.getAttribute('data-tag');
        tagCounts[tag] = (tagCounts[tag] || 0) + 1;
        selectedTags.push(tag);
      });

      const mostCommonTag = Object.entries(tagCounts).sort((a, b) => b[1] - a[1])[0][0];
      const label = labels[currentLang][mostCommonTag] || '';

      let days = total * 3;
      if (tagCounts['water'] >= 2) days += 2;
      if (tagCounts['tech']) days += 1;
      if (tagCounts['vodka'] >= 2) days -= 2;
      if (tagCounts['ice']) days -= 1;
      if (tagCounts['hotdog'] >= 3) days -= 1;

      const comboOutcomes = [
        {
          tags: ['vodka', 'lighter'],
          pl: 'Pr√≥bowa≈Çe≈õ rozpaliƒá ognisko w√≥dƒÖ. Zadzia≈Ça≈Ço. Zbyt dobrze.',
          en: 'You tried to start a fire with vodka. It worked. Too well.'
        },
        {
          tags: ['pierogi', 'sauce'],
          pl: 'Twoje pierogi z czosnkowym zosta≈Çy uznane za walutƒô w postapokalipsie.',
          en: 'Your pierogi with garlic sauce became currency in the wasteland.'
        },
        {
          tags: ['tech', 'sandwich'],
          pl: 'U≈ºy≈Çe≈õ powerbanka do podgrzania kanapki. Kreatywno≈õƒá 10/10.',
          en: 'You used a powerbank to warm up your sandwich. Innovation at its peak.'
        }
      ];

      let funnyEnding = '';
      for (let combo of comboOutcomes) {
        if (combo.tags.every(t => selectedTags.includes(t))) {
          funnyEnding = combo[currentLang];
          break;
        }
      }
      if (!funnyEnding) {
        funnyEnding = currentLang === 'pl'
          ? 'Twoje wybory by≈Çy... interesujƒÖce. Nie przetrwa≈Çe≈õ d≈Çugo, ale zaimponowa≈Çe≈õ dzikom.'
          : 'Your choices were... creative. You didn‚Äôt last long, but you impressed the wild boars.';
      }

      const message = lang[currentLang].survived(days);
      const shareText = lang[currentLang].share(days);
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(shareText);

      document.getElementById('result').innerHTML = `
        <p>${message}</p>
        <p><em>${label ? 'üéñ ' + label : ''}</em></p>
        <p>${funnyEnding}</p>
        <div style="margin-top:10px">
          <a href="https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}" target="_blank">Facebook</a> |
          <a href="https://twitter.com/intent/tweet?text=${text}&url=${url}" target="_blank">Twitter</a> |
          <a href="https://wa.me/?text=${text}%20${url}" target="_blank">WhatsApp</a>
        </div>
        <div class="ad-space">[Reklama Google AdSense tutaj]</div>
      `;
    });
