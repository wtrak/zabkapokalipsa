// Full code remains the same up until the submit event listener

    document.getElementById('gameForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const selected = Array.from(document.querySelectorAll("input[name='item']:checked"));
      if (selected.length !== 10) {
        alert(currentLang === 'pl' ? 'Musisz wybraÄ‡ dokÅ‚adnie 10 przedmiotÃ³w!' : 'You must choose exactly 10 items!');
        return;
      }

      const total = selected.reduce((sum, el) => sum + parseInt(el.value), 0);
      const tagCounts = {};
      const selectedTags = [];

      selected.forEach(el => {
        const tag = el.getAttribute('data-tag');
        tagCounts[tag] = (tagCounts[tag] || 0) + 1;
        selectedTags.push(tag);
      });

      const mostCommonTag = Object.entries(tagCounts).sort((a, b) => b[1] - a[1])[0][0];
      const label = labels[currentLang][mostCommonTag] || '';

      let days = total * 3;
      if (tagCounts['water'] >= 2) days += 2;
      if (tagCounts['tech']) days += 1;
      if (tagCounts['vodka'] >= 2) days -= 2;
      if (tagCounts['ice']) days -= 1;
      if (tagCounts['hotdog'] >= 3) days -= 1;

      const comboOutcomes = [
        {
          tags: ['vodka', 'lighter'],
          pl: 'PrÃ³bowaÅ‚eÅ› rozpaliÄ‡ ognisko wÃ³dÄ…. ZadziaÅ‚aÅ‚o. Zbyt dobrze.',
          en: 'You tried to start a fire with vodka. It worked. Too well.'
        },
        {
          tags: ['pierogi', 'sauce'],
          pl: 'Twoje pierogi z czosnkowym zostaÅ‚y uznane za walutÄ™ w postapokalipsie.',
          en: 'Your pierogi with garlic sauce became currency in the wasteland.'
        },
        {
          tags: ['tech', 'sandwich'],
          pl: 'UÅ¼yÅ‚eÅ› powerbanka do podgrzania kanapki. KreatywnoÅ›Ä‡ 10/10.',
          en: 'You used a powerbank to warm up your sandwich. Innovation at its peak.'
        }
      ];

      let funnyCombo = '';
      for (let combo of comboOutcomes) {
        if (combo.tags.every(t => selectedTags.includes(t))) {
          funnyCombo = combo[currentLang];
          break;
        }
      }

      const endingPool = {
        en: {
          36: [
            "You became known as â€˜the one who lives in the chimney.â€™ You were evicted by a stork.",
            "You survived 39 days under the bleachers of a local Orlik. Then a youth football tournament began.",
            "You lasted 38 days fueled entirely by kabanosy and energy drinks. Then your heart politely gave out.",
            "You were doing fine until day 39, when you tried to make soup in a plastic Å»abka bag.",
            "You survived a month in peace until you challenged a babcia to a shopping cart duel and lost."
          ]
        },
        pl: {
          36: []
        }
      };

      let endingText = '';
      if (endingPool[currentLang] && endingPool[currentLang][36] && days >= 36 && days <= 40) {
        const endings = endingPool[currentLang][36];
        endingText = endings[Math.floor(Math.random() * endings.length)];
      }

      if (!endingText) {
        endingText = currentLang === 'pl'
          ? 'Twoje wybory byÅ‚y... interesujÄ…ce. Nie przetrwaÅ‚eÅ› dÅ‚ugo, ale zaimponowaÅ‚eÅ› dzikom.'
          : 'Your choices were... creative. You didnâ€™t last long, but you impressed the wild boars.';
      }

      const message = lang[currentLang].survived(days);
      const shareText = lang[currentLang].share(days);
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(shareText);

      document.getElementById('result').innerHTML = `
        <p>${message}</p>
        <p><em>${label ? 'ðŸŽ– ' + label : ''}</em></p>
        ${funnyCombo ? `<p>${funnyCombo}</p>` : ''}
        <p>${endingText}</p>
        <div style="margin-top:10px">
          <a href="https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}" target="_blank">Facebook</a> |
          <a href="https://twitter.com/intent/tweet?text=${text}&url=${url}" target="_blank">Twitter</a> |
          <a href="https://wa.me/?text=${text}%20${url}" target="_blank">WhatsApp</a>
        </div>
        <div class="ad-space">[Reklama Google AdSense tutaj]</div>
      `;
    });
